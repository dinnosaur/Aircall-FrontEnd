[![Gitpod ready-to-code](https://img.shields.io/badge/Gitpod-ready--to--code-blue?logo=gitpod)](https://gitpod.io/#https://bitbucket.org/aircall/tractor)

# ü§© @aircall/tractor

The Aircall Tractor design system Foundations.

Latest Staging version available on: [https://tractor.aircall-staging.com/](https://tractor.aircall-staging.com/)

Latest Production version available on: [https://tractor.aircall.io/](https://tractor.aircall.io/)

## ‚ú® Features

- üåà Aircall Design System designed for web applications.
- üì¶ A set of high-quality React components out of the box written with Styled-components.
- üõ° Written in TypeScript with predictable static types.
- üé® Powerful theme customization in every detail.

## üì¶ Install

```bash
npm install --save @aircall/tractor
```

```bash
yarn add @aircall/tractor
```

## üî® Usage

```jsx
import { Tractor, Spacer, Typography } from '@aircall/tractor';

const App = () => (
  <Tractor injectStyle>
    <Spacer space="s">
      <Typography variant="displayM">Hello</Typography>
      <Typography variant="displayL">World</Typography>
    </Spacer>
  </Tractor>
);
```

You are ready to go üöú ‚ö°Ô∏è

> You **must** wrap your React Tree components using the `Tractor` component otherwise the Tractor components won't be able to grab the `theme` thus they will fail.

## ‚å®Ô∏è Development

You first need to clone the repository locally:

```bash
$ git clone git@bitbucket.org:aircall/tractor.git
$ cd tractor
$ yarn
$ yarn start:storybook
```

If you want to test this Design System with your project, you need to:

```bash
$ cd tractor
$ yarn link
$ yarn build:watch
$ cd path/to/your/project
$ yarn link "@aircall/tractor"
```

Make sure that your project is using a single version of React otherwise you will end up having errors:

### Use in create-react-app project

In the real world, we usually have to modify default webpack config for custom needs. We can achieve that by using [craco](https://github.com/gsoft-inc/craco) which is one of create-react-app's custom config solutions.

Install craco and modify the scripts field in `package.json`.

```bash
$ npm install --save-dev @craco/craco
$ yarn add --dev @craco/craco
```

```diff
/* package.json */
"scripts": {
-   "start": "react-scripts start",
-   "build": "react-scripts build",
-   "test": "react-scripts test",
+   "start": "craco start",
+   "build": "craco build",
+   "test": "craco test",
}
```

Then create a `craco.config.js` at root directory of your project for further overriding.

```js
/* craco.config.js */
const path = require('path');

module.exports = {
  webpack: {
    alias: {
      react: path.resolve('./node_modules/react')
    }
  }
};
```

### Use in project using Webpack

```js
/* webpack.config.js */
const path = require('path');

module.exports = {
  resolve: {
    alias: {
      react: path.resolve('./node_modules/react')
    }
  }
};
```

If you are using Jest and in the same time linking tractor locally to your project, you might need to change your craco configuration to the following, in order to resolve the following issue: "hooks can only be called inside the body of a function component".

```js
/* craco.config.js */
const CracoAlias = require('craco-alias');

module.exports = {
  plugins: [
    {
      plugin: CracoAlias,
      options: {
        source: 'options',
        baseUrl: './',
        aliases: {
          // You need to alias react to the one installed in the node_modules
          // in order to solve the error "hooks can only be called inside the body of a function component"
          // which is encountered during jest unit tests described at https://github.com/facebook/react/issues/13991
          react: './node_modules/react'
        }
      }
    }
  ]
};
```

## ü§ù Contributing

### Generating Components

The repo is using [hygen](http://www.hygen.io/) to help us generate components using the command line.

```bash
yarn component HelloWorld
```

The command can take one argument: `--stories`, which determines whether the component should be generated
with a stories.mdx file or not.

### Linting

We decided to use [commitlint](https://github.com/conventional-changelog/commitlint) which is a small library that enforces the [conventional commit format](https://conventionalcommits.org/).

In general the pattern mostly looks like this:

```bash
type(scope?): subject  #scope is optional
```

Real world examples can look like this:

```bash
chore: run tests on travis ci
fix(spacer): fix the margin on the small variant
feat(button): implement new button component
```

We recommend to use the type of the commit followed by the component name if possible and then followed when the actual commit message.

We also encourage developers to split as much as possible their commits into small chunks so that it easy for us to review.

Common types according to [commitlint-config-conventional](https://github.com/conventional-changelog/commitlint/tree/master/%40commitlint/config-conventional#type-enum) can be:

- build
- chore
- ci
- docs
- feat
- fix
- impr
- perf
- refactor
- revert
- style
- test

### Release & Publish

When a or several PRs are merged into master, [standard-version](https://github.com/conventional-changelog/standard-version) will generate the changelog and the bump the version of the package depending on all the commits between the previous tags and the latest commit on master.

Publishing the repository to NPM is a matter of clicking on the Bitbucket Pipeline Publish Button.
